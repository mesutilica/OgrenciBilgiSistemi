<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Öğrenci Bilgi Sistemi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
    <h1>Öğrenci Bilgi Sistemi</h1>
    <p>
        Not : Api serverları güvenlik nedeniyle varsayılan olarak javascript bağlantılarını engeller.
        Bunu açmak için api projemize CORS ayarı yapmamız gerekir.
    </p>
    <hr>
    <h2>Öğrenci Listesi</h2>
    
    <table class="table">
        <tr>
            <th>Id</th>
            <th>Öğrenci Adı</th>
            <th>Öğrenci Soyadı</th>
            <th>Email</th>
            <th>Telefon</th>
            <th>Adres</th>
            <th>Sınıf</th>
            <th></th>
        </tr>
        <tbody id="ogrenciler"></tbody>
    </table>

    <form id="studentForm" action="https://localhost:7250/api/Students"
            method="post">
            <!-- Form alanları buraya eklenecek -->
            <div>
                <input type="text" name="Name" placeholder="Öğrenci Adı">
            </div>
            <div>
                <input type="text" name="Surname" placeholder="Öğrenci Soyadı">
            </div>
            <div>
                <input type="text" name="Email" placeholder="Öğrenci Email">
            </div>
            <div>
                <input type="text" name="Phone" placeholder="Telefon">
            </div>
            <div>
                <textarea name="Address" id="Address" cols="30" rows="10"
                    placeholder="Öğrenci Adres"></textarea>
            </div>
            <div>

                <input type="text" name="StudentClass"
                    placeholder="Öğrenci Sınıfı">
            </div>
            <div>
                <input type="text" name="City" placeholder="Öğrenci Şehri">
            </div>
            <button type="submit">Öğrenci Ekle</button>
        </form>

    <script>
        fetch('https://localhost:7250/api/Students')
        .then(response => response.json()) // datayı jsona dönüştür
        .then(data => {
            console.log('data', data) // gelen datayı tarayıcı konsoluna bas
            let div = document.getElementById("ogrenciler"); // ogrenciler divini seç
            data.forEach(element => {
                // ` tırnağı : ctrl + alt + , e basıp bırakıyoruz sonra boşluğa basıyoruz
                div.innerHTML += `<tr><td>${element.id}</td><td>${element.name}</td><td>${element.surname}</td><td>${element.email}</td><td>${element.phone}</td><td>${element.address}</td><td>${element.studentClass}</td>
                    <td>
                        <input type="button" value="Düzenle" class="btn btn-sm btn-primary" onclick="editStudent(${element.id})">
                        <input type="button" value="Sil" class="btn btn-sm btn-danger" onclick="deleteStudent(${element.id})">
                    </td>
                </tr>`
            });
        });

        function editStudent(id)
        {
            console.log('editStudent', id)
            fetch('https://localhost:7250/api/Students/' + id)
        .then(response => response.json()) // datayı jsona dönüştür
        .then(element => {
            console.log('data', element) // gelen datayı tarayıcı konsoluna bas
            let div = document.getElementById("ogrenciler"); // ogrenciler divini seç
            
                // ` tırnağı : ctrl + alt + , e basıp bırakıyoruz sonra boşluğa basıyoruz
                div.innerHTML += `<tr><td>${element.id}</td><td>${element.name}</td><td>${element.surname}</td><td>${element.email}</td><td>${element.phone}</td><td>${element.address}</td><td>${element.studentClass}</td>
                    <td>
                        <input type="button" value="Düzenle" class="btn btn-sm btn-primary" onclick="editStudent(${element.id})">
                        <input type="button" value="Sil" class="btn btn-sm btn-danger" onclick="deleteStudent(${element.id})">
                    </td>
                </tr>`
            ;
        });
        }
        function deleteStudent(id)
        {
            console.log('editStudent', id)
        }
    </script>
</body>
</html>